#------------------------------------------------------------------------------
# General Configuration
#------------------------------------------------------------------------------
aws_region  = "us-east-1"
name_prefix = "aurora-pg-monitoring"

tags = {
  Purpose     = "guardium-va-config"
  Owner       = "security-team@example.com"
  Environment = "production"
  ManagedBy   = "terraform"
}

#------------------------------------------------------------------------------
# Aurora PostgreSQL Configuration
#------------------------------------------------------------------------------
# The cluster endpoint of your Aurora PostgreSQL cluster
db_host = "your-aurora-cluster.cluster-xxxxx.us-east-1.rds.amazonaws.com"

# Database name (default is 'postgres')
db_name = "postgres"

# Master username for the Aurora cluster
db_username = "postgres"

# Master password for the Aurora cluster (sensitive - use environment variable or secure method)
db_password = "your-secure-password-here"

# Port for Aurora PostgreSQL (default is 5432)
db_port = 5432

#------------------------------------------------------------------------------
# Network Configuration
#------------------------------------------------------------------------------
# VPC ID where the Lambda function will be deployed
vpc_id = "vpc-0123456789abcdef0"

# Subnet IDs where the Lambda function will be deployed (must have connectivity to Aurora cluster)
subnet_ids = ["subnet-0123456789abcdef0", "subnet-0123456789abcdef1"]

#------------------------------------------------------------------------------
# Vulnerability Assessment Configuration
#------------------------------------------------------------------------------
# Username for the Guardium VA user (will be created in Aurora)
sqlguard_username = "sqlguard"

# Password for the sqlguard user (sensitive - use environment variable or secure method)
sqlguard_password = "your-sqlguard-password-here"

#------------------------------------------------------------------------------
# Guardium Data Protection (GDP) Connection Configuration
#------------------------------------------------------------------------------
# Guardium server hostname or IP address
gdp_server = "guardium.example.com"

# Guardium server port (default is 8443)
gdp_port = "8443"

# Guardium username
gdp_username = "admin"

# Guardium password (sensitive - use environment variable or secure method)
gdp_password = "your-guardium-password-here"

# OAuth client ID (default is 'client1')
client_id = "client1"

# OAuth client secret (sensitive - use environment variable or secure method)
# Generate this using: grdapi register_oauth_client client_id=client1 grant_types=password
client_secret = "your-client-secret-here"

#------------------------------------------------------------------------------
# Guardium Data Source Registration Configuration
#------------------------------------------------------------------------------
# Unique name for the datasource in Guardium
datasource_name = "aurora-postgresql-production"

# Description of the datasource
datasource_description = "Aurora PostgreSQL production cluster onboarded via Terraform"

# Application type (default is 'Security Assessment')
application = "Security Assessment"

# Severity level: LOW, NONE, MED, HIGH (default is MED)
severity_level = "MED"

#------------------------------------------------------------------------------
# Vulnerability Assessment Schedule Configuration
#------------------------------------------------------------------------------
# Enable vulnerability assessment (default is true)
enable_vulnerability_assessment = true

# Assessment schedule: daily, weekly, monthly (default is weekly)
assessment_schedule = "weekly"

# Day to run the assessment (e.g., Monday for weekly, 1 for monthly)
assessment_day = "Monday"

# Time to run the assessment in 24-hour format (e.g., 02:00)
assessment_time = "02:00"

#------------------------------------------------------------------------------
# Notification Configuration
#------------------------------------------------------------------------------
# Enable notifications for assessment results (default is true)
enable_notifications = true

# List of email addresses to notify
notification_emails = [
  "security-team@example.com",
  "dba-team@example.com"
]

# Minimum severity level for notifications: HIGH, MED, LOW, NONE (default is HIGH)
notification_severity = "HIGH"

#------------------------------------------------------------------------------
# Optional: Advanced Datasource Connection Options
#------------------------------------------------------------------------------
# Uncomment and configure these options if needed

# Use SSL for database connection
# use_ssl = true

# Import server SSL certificate
# import_server_ssl_cert = true

# Save password in Guardium (default is true)
# save_password = true

# Shared datasource: "Shared", "Not Shared" (default is "Not Shared")
# shared_datasource = "Not Shared"

# Additional connection properties for JDBC URL
# connection_properties = ""

# Custom JDBC URL (overrides host, port, database parameters)
# custom_url = ""

# Use Kerberos authentication
# use_kerberos = false
# kerberos_config_name = ""

# Use LDAP authentication
# use_ldap = false

# Use external password management
# use_external_password = false
# external_password_type_name = ""

# CyberArk configuration
# cyberark_config_name = ""
# cyberark_object_name = ""

# HashiCorp Vault configuration
# hashicorp_config_name = ""
# hashicorp_path = ""
# hashicorp_role = ""
# hashicorp_child_namespace = ""

# AWS Secrets Manager configuration
# aws_secrets_manager_config_name = ""
# region = ""
# secret_name = ""